# LearnBuddy - Autonomous Cognitive Tutor

## Overview

LearnBuddy is an educational web application designed as an autonomous cognitive tutor for children. It provides personalized learning experiences in Reading and Math, with gentle monitoring to ensure joyful, productive learning sessions. The application features separate interfaces for children (learners) and parents (progress monitoring), with a "vibe monitoring" system that tracks the child's emotional state during learning.

## User Preferences

Preferred communication style: Simple, everyday language.

## System Architecture

### Frontend Architecture
- **Framework**: React 18 with TypeScript
- **Routing**: Wouter (lightweight React router)
- **State Management**: TanStack React Query for server state
- **Styling**: Tailwind CSS with shadcn/ui component library (New York style)
- **Animations**: Framer Motion for smooth, child-friendly animations
- **Fonts**: Nunito (child-friendly content) and Inter (UI elements)
- **Theme**: Light/dark mode support with custom CSS variables

The frontend follows a page-based structure with reusable components:
- Landing page for marketing/onboarding
- Child dashboard with gamified progress tracking
- Parent dashboard with analytics and session monitoring
- Reading module with cursor-based word tracking, word highlighting, and AI chatbot assistant
- Math module with adaptive problem generation and AI-powered feedback

### Backend Architecture
- **Runtime**: Node.js with Express 5
- **Language**: TypeScript with ES modules
- **API Style**: RESTful JSON API under `/api/*` prefix
- **Build Tool**: esbuild for server bundling, Vite for client

The server provides endpoints for:
- User management (get by ID, get by username)
- Session tracking (CRUD operations)
- Reading progress tracking
- Math progress tracking
- Vibe state monitoring (emotional state during learning)
- Story content management
- AI Chat (Gemini-powered reading buddy)
- AI Math Help (Gemini-powered feedback)

### AI Integration (Gemini 2.5 Pro)
- **Model**: gemini-2.5-pro for all AI features
- **Reading Buddy**: Agentic chatbot that helps children understand stories, explains vocabulary, and encourages reading comprehension
- **Math Tutor**: Provides personalized feedback after each math problem, explaining mistakes kindly and celebrating successes
- **Word Definitions**: Click any word in the reading interface to get a child-friendly AI explanation
- **Quiz Generation**: AI generates comprehension questions based on story/section content
- **Quiz Evaluation**: AI provides personalized feedback on quiz performance
- **Location**: `server/gemini.ts` contains all Gemini integration code

### PDF Upload & Section-Based Reading
- Users can upload PDF files (up to 10MB) via the reading library page
- PDFs are parsed using `pdf-parse` v2 (PDFParse class with getText() API)
- Text is auto-split into ~300-word sections by paragraph boundaries
- Uploaded PDFs stored as stories with `sourceType: "pdf"` and sections as JSON array
- Section navigation (prev/next) available for multi-section PDF stories
- Each section has its own quiz generated from section content only

### Reading Comprehension Quizzes
- Quizzes appear after child reads 90%+ of a story or section
- 3 multiple choice questions generated by AI based on story/section content
- For PDF stories with sections, quizzes are scoped to the current section
- Fallback questions available when API is unavailable
- Results stored and visible on parent dashboard
- Pass threshold: 70% correct answers
- AI feedback explains performance and encourages improvement

### Data Storage
- **ORM**: Drizzle ORM with PostgreSQL dialect
- **Schema Location**: `shared/schema.ts` (shared between client and server)
- **Migrations**: Drizzle Kit with output to `./migrations`
- **Current Implementation**: In-memory storage class (`MemStorage`) with interface for easy database swap

Database tables:
- `users`: Learner and parent accounts with roles
- `sessions`: Learning session tracking with duration
- `reading_progress`: Per-story reading metrics and position
- `math_progress`: Problem attempts, accuracy, levels, and streaks
- `vibe_states`: Emotional state snapshots during sessions
- `stories`: Reading content library
- `chat_messages`: AI chat conversation history per user/story
- `quizzes`: Reading comprehension quiz questions, answers, and results

### Design Patterns
- **Shared Schema**: Zod schemas generated from Drizzle for validation on both client and server
- **Interface-based Storage**: `IStorage` interface allows swapping between in-memory and database implementations
- **Component Library**: shadcn/ui components with custom child-friendly adaptations per design guidelines
- **Path Aliases**: `@/` for client source, `@shared/` for shared code

## External Dependencies

### UI Component Libraries
- Radix UI primitives (dialogs, dropdowns, tooltips, etc.)
- shadcn/ui built on top of Radix
- Framer Motion for animations
- Lucide React for icons
- Embla Carousel for carousels

### Database & Backend
- PostgreSQL (via `DATABASE_URL` environment variable)
- Drizzle ORM for type-safe database operations
- connect-pg-simple for session storage
- express-session for session management

### Development Tools
- Vite with React plugin for frontend development
- Replit-specific plugins for development (error overlay, cartographer, dev banner)
- TypeScript for type safety throughout

### Fonts
- Google Fonts: Nunito (child content) and Inter (UI elements)